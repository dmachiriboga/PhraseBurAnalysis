# Data Directory

This directory contains Beat-Upbeat Ratio (BUR) data extracted from jazz solos in the Weimar Jazz Database.

## Files

### `phrasebur_raw.csv`
**Original unfiltered data** exported from the Weimar Jazz Database using MeloSpyGUI.

- **Rows**: 40,794 BUR values
- **Phrases**: 8,306 phrase segments
- **Source**: Weimar Jazz Database solo transcriptions
- **Format**: Semicolon-delimited CSV

### `phrasebur_filtered.csv`
**Filtered data** containing only phrases with sufficient data points for statistical analysis.

- **Rows**: 26,801 BUR values
- **Phrases**: 2,488 phrase segments
- **Filter criterion**: Minimum 6 BUR values per phrase (n ≥ 6)
- **Generated by**: `python utils/clean_data.py`

## Data Structure

Each CSV file has the following columns:

| Column | Description |
|--------|-------------|
| `id` | Solo identifier (performer + tune name) |
| `seg_type` | Segment type (always "phrases") |
| `seg_id` | Phrase identifier within the solo |
| `swing_ratios` | Beat-Upbeat Ratio (BUR) value for an eighth-note pair |

**Important**: Each row represents one **BUR value** (calculated from one eighth-note pair), not one musical note. A phrase consists of multiple rows with the same `id` and `seg_id`.

## Filtering Rationale

### Why n ≥ 6?

Phrases with fewer than 6 BUR values lack sufficient data for reliable statistical analysis:

1. **Linear regression** (surge analysis): With n=3, only 1 degree of freedom; n=6 provides 4 degrees of freedom
2. **Phrase structure analysis**: With n=3, the "middle section" has only 1 value, making standard deviation undefined
3. **Variation analysis**: Standard deviation requires adequate sample size for meaningful interpretation

### Data Removed

| Metric | Raw Data | Filtered Data | Removed | % Removed |
|--------|----------|---------------|---------|-----------|
| **BUR values (rows)** | 40,794 | 26,801 | 13,993 | 34.3% |
| **Phrases** | 8,306 | 2,488 | 5,818 | 70.0% |

### Phrase Length Distribution (Raw Data)

| Phrase Length (n) | Count | Percentage |
|-------------------|-------|------------|
| n = 1 | 1,980 | 23.8% |
| n = 2 | 1,236 | 14.9% |
| n = 3 | 953 | 11.5% |
| n = 4 | 755 | 9.1% |
| n = 5 | 594 | 7.2% |
| **n ≥ 6** | **2,488** | **30.0%** |
| n ≥ 10 | 1,044 | 12.6% |
| n ≥ 20 | 285 | 3.4% |

The filtered dataset (n ≥ 6) represents the most substantial 30% of phrases with sufficient eighth-note density for robust statistical analysis.

## Regenerating Filtered Data

To regenerate `phrasebur_filtered.csv` from `phrasebur_raw.csv`:

```bash
python utils/clean_data.py
```

To use a different minimum threshold:

```bash
python utils/clean_data.py --min-values 10
```

## Data Interpretation

### What is BUR?

The Beat-Upbeat Ratio (BUR) quantifies swing timing in jazz:
- **BUR = duration(beat) / duration(upbeat)** for consecutive eighth notes
- BUR > 1: "Swung" eighth notes (beat is longer than upbeat)
- BUR = 1: "Straight" eighth notes (equal duration)
- BUR < 1: "Reverse swing" (upbeat longer than beat)

### Why Single-Note Phrases?

Phrases with n=1 are not segmentation errors. They represent musically complete phrases that contain only one eighth-note pair in swung rhythm. These phrases may use:
- Quarter notes, half notes, whole notes
- Triplets or other non-eighth-note rhythms
- Mixed rhythmic content with minimal swung eighth notes

BUR can **only be calculated for consecutive eighth-note pairs**. A phrase with n=1 has exactly one swung eighth-note pair and possibly many other note values.

## Usage in Analysis

All analysis scripts default to using **`phrasebur_filtered.csv`** via the `load_phrasebur_csv()` function in `utils/data_utils.py`. To analyze raw data instead:

```python
from utils.data_utils import load_phrasebur_csv

# Use filtered data (default)
df = load_phrasebur_csv()

# Use raw data
df = load_phrasebur_csv("data/phrasebur_raw.csv")
```
